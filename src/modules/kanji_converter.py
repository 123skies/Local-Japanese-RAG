# modules/kanji_converter.py

# --- 簡体字・繁体字 -> 日本語新字体 変換マップ ---
# LLMがよく出力してしまう簡体字/繁体字を、日本語の標準的な漢字に置換します。
KANJI_CONVERSION_MAP = str.maketrans({
    '亞': '亜',
    '亚': '亜',
    '啞': '唖',
    '哑': '唖',
    '惡': '悪',
    '恶': '悪',
    '蘆': '芦',
    '鰺': '鯵',
    '鲹': '鯵',
    '壓': '圧',
    '压': '圧',
    '圍': '囲',
    '围': '囲',
    '爲': '為',
    '为': '為',
    '醫': '医',
    '壹': '壱',
    '稻': '稲',
    '飮': '飲',
    '隱': '隠',
    '隐': '隠',
    '噓': '嘘',
    '營': '営',
    '营': '営',
    '榮': '栄',
    '荣': '栄',
    '穎': '頴',
    '颖': '頴',
    '衞': '衛',
    '銳': '鋭',
    '锐': '鋭',
    '驛': '駅',
    '驿': '駅',
    '悅': '悦',
    '谒': '謁',
    '閱': '閲',
    '阅': '閲',
    '圓': '円',
    '圆': '円',
    '焰': '焔',
    '緣': '縁',
    '缘': '縁',
    '艷': '艶',
    '艳': '艶',
    '鹽': '塩',
    '盐': '塩',
    '奧': '奥',
    '應': '応',
    '应': '応',
    '橫': '横',
    '歐': '欧',
    '毆': '殴',
    '鶯': '鴬',
    '莺': '鴬',
    '鷗': '鴎',
    '鸥': '鴎',
    '黃': '黄',
    '溫': '温',
    '穩': '穏',
    '稳': '穏',
    '假': '仮',
    '價': '価',
    '价': '価',
    '祸': '禍',
    '畫': '画',
    '划': '画',
    '會': '会',
    '壞': '壊',
    '坏': '壊',
    '懷': '懐',
    '怀': '懐',
    '繪': '絵',
    '绘': '絵',
    '槪': '概',
    '蠣': '蛎',
    '擴': '拡',
    '扩': '拡',
    '攪': '撹',
    '搅': '撹',
    '殼': '殻',
    '壳': '殻',
    '覺': '覚',
    '觉': '覚',
    '學': '学',
    '嶽': '岳',
    '樂': '楽',
    '乐': '楽',
    '渴': '渇',
    '竈': '竃',
    '灶': '竃',
    '嚙': '噛',
    '啮': '噛',
    '勸': '勧',
    '劝': '勧',
    '卷': '巻',
    '寬': '寛',
    '宽': '寛',
    '歡': '歓',
    '欢': '歓',
    '汉': '漢',
    '灌': '潅',
    '罐': '缶',
    '觀': '観',
    '观': '観',
    '諫': '諌',
    '谏': '諌',
    '閒': '間',
    '闲': '間',
    '關': '関',
    '关': '関',
    '陷': '陥',
    '馆': '館',
    '巖': '巌',
    '岩': '巌',
    '顏': '顔',
    '颜': '顔',
    '歸': '帰',
    '归': '帰',
    '氣': '気',
    '气': '気',
    '龜': '亀',
    '龟': '亀',
    '僞': '偽',
    '伪': '偽',
    '戲': '戯',
    '戏': '戯',
    '犧': '犠',
    '牺': '犠',
    '舊': '旧',
    '據': '拠',
    '据': '拠',
    '擧': '挙',
    '虛': '虚',
    '俠': '侠',
    '峽': '峡',
    '强': '強',
    '挾': '挟',
    '敎': '教',
    '狹': '狭',
    '鄕': '郷',
    '响': '響',
    '堯': '尭',
    '尧': '尭',
    '曉': '暁',
    '晓': '暁',
    '谨': '謹',
    '俱': '倶',
    '區': '区',
    '軀': '躯',
    '驅': '駆',
    '驱': '駆',
    '勳': '勲',
    '薰': '薫',
    '徑': '径',
    '惠': '恵',
    '揭': '掲',
    '溪': '渓',
    '經': '経',
    '经': '経',
    '繼': '継',
    '继': '継',
    '繫': '繋',
    '系': '繋',
    '莖': '茎',
    '螢': '蛍',
    '萤': '蛍',
    '輕': '軽',
    '轻': '軽',
    '頸': '頚',
    '颈': '頚',
    '鷄': '鶏',
    '鸡': '鶏',
    '藝': '芸',
    '艺': '芸',
    '擊': '撃',
    '击': '撃',
    '缺': '欠',
    '儉': '倹',
    '俭': '倹',
    '劍': '剣',
    '剑': '剣',
    '圈': '圏',
    '檢': '検',
    '检': '検',
    '權': '権',
    '权': '権',
    '獻': '献',
    '硏': '研',
    '縣': '県',
    '县': '県',
    '險': '険',
    '险': '険',
    '顯': '顕',
    '显': '顕',
    '驗': '験',
    '验': '験',
    '鹼': '鹸',
    '硷': '鹸',
    '嚴': '厳',
    '严': '厳',
    '戶': '戸',
    '户': '戸',
    '吳': '呉',
    '吴': '呉',
    '娛': '娯',
    '娱': '娯',
    '效': '効',
    '廣': '広',
    '广': '広',
    '恆': '恒',
    '鑛': '鉱',
    '礦': '砿',
    '矿': '砿',
    '號': '号',
    '麴': '麹',
    '吿': '告',
    '國': '国',
    '谷': '穀',
    '黑': '黒',
    '歲': '歳',
    '岁': '歳',
    '濟': '済',
    '济': '済',
    '碎': '砕',
    '齋': '斎',
    '斋': '斎',
    '劑': '剤',
    '剂': '剤',
    '栅': '柵',
    '櫻': '桜',
    '樱': '桜',
    '剷': '冊',
    '杀': '殺',
    '雜': '雑',
    '杂': '雑',
    '參': '参',
    '慘': '惨',
    '棧': '桟',
    '栈': '桟',
    '產': '産',
    '产': '産',
    '蠶': '蚕',
    '贊': '賛',
    '赞': '賛',
    '殘': '残',
    '絲': '糸',
    '丝': '糸',
    '视': '視',
    '饲': '飼',
    '齒': '歯',
    '齿': '歯',
    '剝': '児',
    '儿': '児',
    '辭': '辞',
    '濕': '湿',
    '實': '実',
    '实': '実',
    '屢': '屡',
    '蘂': '蕊',
    '舍': '舎',
    '寫': '写',
    '釋': '釈',
    '释': '釈',
    '壽': '寿',
    '收': '収',
    '繡': '繍',
    '绣': '繍',
    '從': '従',
    '从': '従',
    '澁': '渋',
    '獸': '獣',
    '兽': '獣',
    '縱': '縦',
    '纵': '縦',
    '肅': '粛',
    '肃': '粛',
    '處': '処',
    '处': '処',
    '緖': '緒',
    '诸': '諸',
    '敍': '叙',
    '奬': '奨',
    '奖': '奨',
    '將': '将',
    '尙': '尚',
    '涉': '渉',
    '燒': '焼',
    '烧': '焼',
    '稱': '称',
    '蔣': '蒋',
    '證': '証',
    '证': '証',
    '醬': '醤',
    '酱': '醤',
    '乘': '乗',
    '兗': '剰',
    '壤': '壌',
    '孃': '嬢',
    '娘': '嬢',
    '條': '条',
    '淨': '浄',
    '净': '浄',
    '狀': '状',
    '疊': '畳',
    '叠': '畳',
    '穰': '穣',
    '讓': '譲',
    '让': '譲',
    '釀': '醸',
    '酿': '醸',
    '囑': '嘱',
    '觸': '触',
    '寢': '寝',
    '愼': '慎',
    '晉': '晋',
    '眞': '真',
    '盡': '尽',
    '靱': '靭',
    '圖': '図',
    '图': '図',
    '粹': '粋',
    '醉': '酔',
    '隨': '随',
    '髓': '髄',
    '數': '数',
    '樞': '枢',
    '瀨': '瀬',
    '濑': '瀬',
    '淸': '清',
    '聲': '声',
    '靑': '青',
    '靜': '静',
    '齊': '斉',
    '齐': '斉',
    '稅': '税',
    '攝': '摂',
    '摄': '摂',
    '竊': '窃',
    '节': '節',
    '說': '説',
    '说': '説',
    '絕': '絶',
    '绝': '絶',
    '蟬': '蝉',
    '專': '専',
    '专': '専',
    '戰': '戦',
    '战': '戦',
    '淺': '浅',
    '潛': '潜',
    '纖': '繊',
    '纤': '繊',
    '賤': '賎',
    '贱': '賎',
    '踐': '践',
    '錢': '銭',
    '钱': '銭',
    '禪': '禅',
    '曾': '曽',
    '雙': '双',
    '壯': '壮',
    '层': '層',
    '搜': '捜',
    '插': '挿',
    '搔': '掻',
    '巢': '巣',
    '爭': '争',
    '瘦': '痩',
    '總': '総',
    '总': '総',
    '聰': '聡',
    '聪': '聡',
    '莊': '荘',
    '庄': '荘',
    '裝': '装',
    '騷': '騒',
    '骚': '騒',
    '增': '増',
    '臟': '臓',
    '脏': '臓',
    '藏': '蔵',
    '赠': '贈',
    '卽': '即',
    '屬': '属',
    '續': '続',
    '续': '続',
    '墮': '堕',
    '驒': '騨',
    '體': '体',
    '對': '対',
    '对': '対',
    '帶': '帯',
    '带': '帯',
    '滯': '滞',
    '臺': '台',
    '瀧': '滝',
    '泷': '滝',
    '擇': '択',
    '择': '択',
    '澤': '沢',
    '泽': '沢',
    '脫': '脱',
    '單': '単',
    '单': '単',
    '叹': '嘆',
    '擔': '担',
    '簞': '箪',
    '膽': '胆',
    '團': '団',
    '团': '団',
    '彈': '弾',
    '弹': '弾',
    '斷': '断',
    '癡': '痴',
    '遲': '遅',
    '迟': '遅',
    '晝': '昼',
    '蟲': '虫',
    '鑄': '鋳',
    '铸': '鋳',
    '着': '著',
    '廳': '庁',
    '徵': '徴',
    '征': '徴',
    '惩': '懲',
    '聽': '聴',
    '听': '聴',
    '敕': '勅',
    '鎭': '鎮',
    '摑': '掴',
    '壺': '壷',
    '壶': '壷',
    '祯': '禎',
    '遞': '逓',
    '递': '逓',
    '鐵': '鉄',
    '铁': '鉄',
    '塡': '填',
    '轉': '転',
    '转': '転',
    '顚': '顛',
    '點': '点',
    '傳': '伝',
    '传': '伝',
    '礪': '砺',
    '黨': '党',
    '檮': '梼',
    '盜': '盗',
    '濤': '涛',
    '燈': '灯',
    '當': '当',
    '禱': '祷',
    '鬭': '闘',
    '德': '徳',
    '瀆': '涜',
    '渎': '涜',
    '獨': '独',
    '讀': '読',
    '读': '読',
    '屆': '届',
    '吞': '呑',
    '剮': '内',
    '繩': '縄',
    '绳': '縄',
    '难': '難',
    '貳': '弐',
    '贰': '弐',
    '邇': '迩',
    '禰': '祢',
    '囊': '嚢',
    '惱': '悩',
    '恼': '悩',
    '腦': '脳',
    '脑': '脳',
    '霸': '覇',
    '廢': '廃',
    '废': '廃',
    '拜': '拝',
    '賣': '売',
    '卖': '売',
    '蠅': '蝿',
    '蝇': '蝿',
    '兒': '剥',
    '麥': '麦',
    '潑': '溌',
    '泼': '溌',
    '發': '発',
    '发': '発',
    '醱': '醗',
    '酦': '醗',
    '髮': '髪',
    '发': '髪',
    '拔': '抜',
    '饭': '飯',
    '晚': '晩',
    '蠻': '蛮',
    '祕': '秘',
    '彥': '彦',
    '檜': '桧',
    '姬': '姫',
    '濱': '浜',
    '滨': '浜',
    '宾': '賓',
    '频': '頻',
    '甁': '瓶',
    '拂': '払',
    '佛': '仏',
    '倂': '併',
    '竝': '並',
    '變': '変',
    '变': '変',
    '邊': '辺',
    '边': '辺',
    '瓣': '弁',
    '辨': '弁',
    '辯': '弁',
    '辩': '弁',
    '舖': '舗',
    '步': '歩',
    '穗': '穂',
    '寶': '宝',
    '襃': '褒',
    '豐': '豊',
    '丰': '豊',
    '頰': '頬',
    '颊': '頬',
    '沒': '没',
    '飜': '翻',
    '每': '毎',
    '槇': '槙',
    '儘': '侭',
    '尽': '侭',
    '萬': '万',
    '滿': '満',
    '满': '満',
    '剛': '免',
    '麵': '麺',
    '面': '麺',
    '默': '黙',
    '餠': '餅',
    '戾': '戻',
    '彌': '弥',
    '藥': '薬',
    '药': '薬',
    '譯': '訳',
    '译': '訳',
    '藪': '薮',
    '佑': '祐',
    '豫': '予',
    '餘': '余',
    '與': '与',
    '譽': '誉',
    '搖': '揺',
    '摇': '揺',
    '樣': '様',
    '样': '様',
    '謠': '謡',
    '谣': '謡',
    '遙': '遥',
    '來': '来',
    '萊': '莱',
    '賴': '頼',
    '赖': '頼',
    '亂': '乱',
    '栏': '欄',
    '覽': '覧',
    '览': '覧',
    '龍': '竜',
    '龙': '竜',
    '虏': '虜',
    '剴': '両',
    '两': '両',
    '獵': '猟',
    '猎': '猟',
    '綠': '緑',
    '绿': '緑',
    '壘': '塁',
    '垒': '塁',
    '淚': '涙',
    '泪': '涙',
    '类': '類',
    '勵': '励',
    '禮': '礼',
    '隸': '隷',
    '隶': '隷',
    '靈': '霊',
    '灵': '霊',
    '齡': '齢',
    '龄': '齢',
    '曆': '暦',
    '历': '暦',
    '歷': '歴',
    '历': '歴',
    '戀': '恋',
    '练': '練',
    '鍊': '錬',
    '链': '錬',
    '爐': '炉',
    '勞': '労',
    '劳': '労',
    '樓': '楼',
    '籠': '篭',
    '笼': '篭',
    '蠟': '蝋',
    '蜡': '蝋',
    '郞': '郎',
    '祿': '禄',
    '錄': '録',
    '录': '録',
    '亙': '亘',
    '灣': '湾',
    '倅': '伜',
    '埒': '埓',
    '姸': '妍',
    '屛': '屏',
    '幷': '并',
    '奘': '弉',
    '彎': '弯',
    '懺': '懴',
    '忏': '懴',
    '攢': '攅',
    '攒': '攅',
    '曠': '昿',
    '旷': '昿',
    '栃': '杤',
    '櫨': '枦',
    '栌': '枦',
    '桝': '枡',
    '檳': '梹',
    '槟': '梹',
    '櫳': '槞',
    '栊': '槞',
    '櫟': '檪',
    '栎': '檪',
    '殲': '殱',
    '歼': '殱',
    '瑤': '瑶',
    '瓔': '珱',
    '璎': '珱',
    '疇': '畴',
    '箏': '筝',
    '纃': '緕',
    '翠': '翆',
    '艫': '舮',
    '舻': '舮',
    '襌': '褝',
    '譖': '譛',
    '谮': '譛',
    '質': '貭',
    '质': '貭',
    '轟': '軣',
    '轰': '軣',
    '輛': '輌',
    '辆': '輌',
    '逬': '迸',
    '鐸': '鈬',
    '铎': '鈬',
    '鑪': '鈩',
    '鰮': '鰛',
    '鳁': '鰛',
    '鶇': '鶫',
    '鸫': '鶫',
    '鷆': '鷏',
    '麩': '麸',
    '鼠': '鼡',
    '濾': '沪',
    '滤': '沪',
})

def normalize_kanji(text):
    """簡体字や繁体字を日本語の標準的な漢字に変換する"""
    if not text: return text
    return text.translate(KANJI_CONVERSION_MAP)